const e=new class{constructor(e=null){this.board=e||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.size=4,this.status="idle",this.score=0}moveLeft(){let e=this.board.map(e=>e.slice());if(!this.handleGameOver()){for(let e=0;e<this.board.length;e++)this.board[e]=this.mergeX(this.board[e]);this.boardsAreEqual(e,this.board)||this.addRandomTile(),this.updateScore(),this.renderBoard(this.board),this.checkWin()}}moveRight(){let e=this.board.map(e=>e.slice());if(!this.handleGameOver()){for(let e=0;e<this.board.length;e++)this.board[e]=this.mergeX(this.board[e],!0);this.boardsAreEqual(e,this.board)||this.addRandomTile(),this.updateScore(),this.renderBoard(this.board),this.checkWin()}}moveUp(){let e=this.board.map(e=>e.slice());this.handleGameOver()||(this.mergeY(!1),this.boardsAreEqual(e,this.board)||this.addRandomTile(),this.updateScore(),this.renderBoard(this.board),this.checkWin())}moveDown(){let e=this.board.map(e=>e.slice());this.handleGameOver()||(this.mergeY(!0),this.boardsAreEqual(e,this.board)||this.addRandomTile(),this.updateScore(),this.renderBoard(this.board),this.checkWin())}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}start(){this.status="playing",this.renderBoard(this.board),this.addRandomTile(),this.addRandomTile()}restart(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.status="playing",this.score=0,this.addRandomTile(),this.addRandomTile()}mergeY(e=!1){for(let t=0;t<this.board.length;t++){let s=[];for(let e=0;e<this.board.length;e++)s.push(this.board[e][t]);e&&s.reverse(),s=s.filter(e=>0!==e);for(let e=0;e<s.length-1;e++)s[e]===s[e+1]&&(s[e]+=s[e+1],this.score+=s[e],s[e+1]=0,e++);for(s=s.filter(e=>0!==e);s.length<this.size;)s.push(0);e&&s.reverse();for(let e=0;e<this.size;e++)this.board[e][t]=s[e]}}mergeX(e,t=!1){let s=t?e.slice().reverse():e.slice();s=s.filter(e=>0!==e);for(let e=0;e<s.length-1;e++)s[e]===s[e+1]&&(s[e]+=s[e+1],this.score+=s[e],s[e+1]=0,e++);for(s=s.filter(e=>0!==e);s.length<this.size;)s.push(0);return t&&s.reverse(),s}renderBoard(e){let t=document.querySelectorAll(".field-cell");for(let s=0;s<e.length;s++)for(let r=0;r<e[s].length;r++){let i=t[s*this.size+r],a=e[s][r];i.textContent=0===a?"":a,i.className="field-cell",a>0?i.classList.add(`field-cell--${a}`):i.className="field-cell"}}updateScore(){document.querySelector(".game-score").textContent=this.score}createEmptyBoard(){let e=[];for(let t=0;t<this.size;t++)e.push([0,0,0,0]);return e}addRandomTile(){let e=[];for(let t=0;t<this.size;t++)for(let s=0;s<this.size;s++)0===this.board[t][s]&&e.push({row:t,col:s});if(e.length>0){let t=Math.floor(Math.random()*e.length),{row:s,col:r}=e[t],i=.9>Math.random()?2:4;this.board[s][r]=i}}boardsAreEqual(e,t){for(let s=0;s<e.length;s++)for(let r=0;r<e[s].length;r++)if(e[s][r]!==t[s][r])return!1;return!0}checkWin(){for(let e of this.board)for(let t of e)if(2048===t){this.status="win",this.winMessage();return}}winMessage(){document.querySelector(".message-win").classList.remove("hidden")}checkMove(){for(let e=0;e<this.board.length;e++)for(let t=0;t<this.board[e].length;t++)if(0===this.board[e][t]||t<this.board[e].length-1&&this.board[e][t]===this.board[e][t+1]||e<this.board.length-1&&this.board[e][t]===this.board[e+1][t])return!0;return!1}gameOverMessage(){document.querySelector(".message-lose").classList.remove("hidden")}handleGameOver(){return!1===this.checkMove()&&(this.status="lose",this.gameOverMessage(),!0)}},t=document.querySelector(".start");t.addEventListener("click",s=>{s.preventDefault(),t.classList.contains("start")?(e.start(),t.classList.remove("start"),t.classList.add("restart"),t.textContent="Restart",document.querySelector(".message-start").classList.add("hidden")):t.classList.contains("restart")&&(e.restart(),document.querySelector(".message-win").classList.add("hidden"),document.querySelector(".message-lose").classList.add("hidden")),e.renderBoard(e.getState()),e.updateScore(e.getScore())}),document.addEventListener("keydown",t=>{switch(t.key){case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight();break;case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown()}});
//# sourceMappingURL=index.89a17821.js.map
